<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Reghype</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500&family=Roboto&display=swap" rel="stylesheet">

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<style>
body { 
  margin:0; 
  font-family:'Roboto',sans-serif; 
  background: linear-gradient(135deg,#0d0d0d,#1a1a1a);
  color:#fff; 
  text-align:center; 
  overflow-x:hidden; 
}

h1 { 
  font-family:'Orbitron',sans-serif; 
  color:#ffcc00; 
  margin:20px 0; 
  cursor:pointer; 
  text-shadow:0 0 10px #ffcc00; 
}

button { 
  padding:12px 25px; 
  margin:10px; 
  border:none; 
  border-radius:12px;
  background: linear-gradient(45deg,#ff6600,#ffcc00); 
  font-weight:bold; 
  color:#000; 
  font-size:18px; 
  cursor:pointer; 
  transition:0.3s;
}

button:hover{
  transform:scale(1.05);
}

#currency{
  font-size:22px;
  margin:10px;
  color:#00ff99;
  font-weight:bold;
}

#lastCard .card {
  max-width: 150px; /* —É–º–µ–Ω—å—à–∏–ª–∏ —Ä–∞–∑–º–µ—Ä –∫–∞—Ä—Ç–æ—á–∫–∏ */
  font-size: 16px;  /* —Å–¥–µ–ª–∞–ª–∏ —Ç–µ–∫—Å—Ç –ø–æ–º–µ–Ω—å—à–µ */
  margin: 12px auto; /* —Ü–µ–Ω—Ç—Ä–∏—Ä—É–µ–º –∫–∞—Ä—Ç–æ—á–∫—É */
}

#lastCard .card img {
  max-width: 100%;
  height: auto;
  border-radius: 14px;
}


.card{
  display:inline-block; 
  margin:10px; 
  text-align:center; 
  transition:0.5s; 
  border-radius:12px; 
  padding:5px; 
  position:relative;
}

.card img{
  max-width:150px; 
  border-radius:12px; 
  transition:0.5s;
}

.rarity-Common{
  border:3px solid gray; 
  box-shadow:0 0 15px gray;
}

.rarity-Rare{
  border:3px solid #3399ff; 
  box-shadow:0 0 15px #3399ff; 
  animation:glowBlue 2s infinite alternate;
}

.rarity-Special{
  border:3px solid #cc33ff; 
  box-shadow:0 0 20px #cc33ff; 
  animation:glowPurple 2s infinite alternate;
}

.rarity-Legendary{
  border:3px solid gold; 
  box-shadow:0 0 25px gold; 
  animation:glowGold 2s infinite alternate;
}

@keyframes glowBlue{
  0%{box-shadow:0 0 15px #3399ff;}
  100%{box-shadow:0 0 30px #33f;}
}

@keyframes glowPurple{
  0%{box-shadow:0 0 15px #cc33ff;}
  100%{box-shadow:0 0 35px #f3f;}
}

@keyframes glowGold{
  0%{box-shadow:0 0 20px gold;}
  100%{box-shadow:0 0 40px #ff0;}
}

.animate-card{
  transform:scale(0) rotateY(0deg); 
  animation:popCard 0.8s forwards;
}

@keyframes popCard{
  0%{transform:scale(0) rotateY(0deg);opacity:0;}
  50%{transform:scale(1.3) rotateY(180deg);opacity:1;}
  100%{transform:scale(1) rotateY(360deg);opacity:1;}
}

.timer{
  font-size:16px;
  color:#ff6666;
  margin:10px;
}

#collection {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  margin-bottom: 80px;
  margin-top: 20px;
}

h2 {
  margin-top: 40px;
  margin-bottom: 25px;
  font-size: 24px;
  text-align: center;
}

/* –ê–î–ú–ò–ù –ü–ê–ù–ï–õ–¨ */
#adminPanel{
  position:fixed; 
  top:50px; 
  right:-400px; 
  width:360px; 
  background:#111; 
  border:2px solid #ffcc00; 
  border-radius:10px; 
  padding:20px; 
  transition:0.5s; 
  z-index:1000;
}

#adminPanel.show{
  right:20px;
}

#adminPanel h2{
  color:#ffcc00;
  margin-top:0;
  font-family:'Orbitron',sans-serif;
}

#adminPanel button{
  width:90%;
  margin:5px;
}

/* –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –ö–ê–†–¢–û–ß–ö–ò */
#cardModal{
  display:none; 
  position:fixed; 
  top:0; 
  left:0; 
  width:100%; 
  height:100%; 
  background:rgba(0,0,0,0.85); 
  justify-content:center; 
  align-items:center; 
  z-index:2000;
}

#cardContent {
  background: #111;
  padding: 15px;
  border: 2px solid #ffcc00;
  border-radius: 12px;
  text-align: center;
  position: relative;
  max-width: 240px;   /* –º–µ–Ω—å—à–µ */
  transform: scale(0.9); /* —á—É—Ç—å —Å–∂–∞—Ç–æ–µ */
  animation: modalPop 0.4s forwards;
}


#cardContent img{
  max-width:100%;
  border-radius:12px;
  box-shadow:0 0 20px gold;
  margin-bottom:10px;
}

@keyframes modalPop{
  0%{transform:scale(0);}
  60%{transform:scale(1.2);}
  100%{transform:scale(1);}
}

#cardContent button{
  padding:8px 15px;
  margin-top:10px;
  border:none;
  border-radius:8px;
  background:#ff3333;
  color:#fff;
  cursor:pointer;
  transition:0.3s;
}

#cardContent button:hover{
  transform:scale(1.05);
}

/* –ù–ê–í–ë–ê–† */
#navbar {
  display: flex;
  justify-content: space-around;
  background: #111;
  padding: 15px 10px;
  border-top: 2px solid #ffcc00;
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  z-index: 3000;
}

#navbar button {
  flex: 1;
  margin: 0 5px;
  padding: 12px 10px;
  background: linear-gradient(45deg,#ff6600,#ffcc00);
  border: none;
  border-radius: 8px;
  font-weight: bold;
  cursor: pointer;
  transition: 0.3s;
}

#navbar button:hover {
  transform: scale(1.05);
}

#navbar button.active {
  background: linear-gradient(45deg,#00ff99,#ffcc00);
  box-shadow: 0 0 15px rgba(0, 255, 153, 0.5);
}

/* –ú–û–î–ê–õ–¨–ù–´–ï –û–ö–ù–ê –ú–ï–ù–Æ */
.menu-modal {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.8);
  backdrop-filter: blur(5px);
  z-index: 4000;
  animation: fadeIn 0.3s ease-out;
}

.menu-content {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background: linear-gradient(135deg, #1a1a1a, #2d2d2d);
  border: 3px solid #ffcc00;
  border-radius: 20px;
  padding: 30px;
  width: 90vw;
  max-width: 600px;
  max-height: 80vh;
  overflow-y: auto;
  box-shadow: 0 0 50px rgba(255, 204, 0, 0.3);
  animation: slideIn 0.4s ease-out;
}

.menu-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 25px;
  border-bottom: 2px solid #ffcc00;
  padding-bottom: 15px;
}

.menu-title {
  font-family: 'Orbitron', sans-serif;
  color: #ffcc00;
  font-size: 28px;
  text-shadow: 0 0 10px #ffcc00;
  margin: 0;
}

.close-btn {
  background: none;
  border: none;
  color: #ff3333;
  font-size: 32px;
  cursor: pointer;
  transition: 0.3s;
  padding: 5px 10px;
  border-radius: 50%;
}

.close-btn:hover {
  background: rgba(255, 51, 51, 0.2);
  transform: rotate(90deg);
}

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes slideIn {
  from { 
    opacity: 0;
    transform: translate(-50%, -60%);
  }
  to { 
    opacity: 1;
    transform: translate(-50%, -50%);
  }
}

/* –°–¢–ò–õ–ò –î–õ–Ø –ö–û–¢–ò–ö–ê */
.cat-container {
  display: inline-block;
  margin: 20px;
  cursor: pointer;
  transition: transform 0.2s;
}

.cat-container:hover {
  transform: scale(1.05);
}

.cat-container:active {
  transform: scale(0.95);
}

#catVideo {
  width: 200px;
  height: 200px;
  border-radius: 15px;
  border: 3px solid #ffcc00;
  box-shadow: 0 0 20px rgba(255, 204, 0, 0.5);
  object-fit: cover;
}

.click-effect {
  animation: clickPulse 0.3s ease-out;
}

@keyframes clickPulse {
  0% { transform: scale(1); }
  50% { transform: scale(1.1); }
  100% { transform: scale(1); }
}
</style>
</head>
<body>

<h1 id="logo">Reghype</h1>
<div id="currency">üí∞ –í–∞–ª—é—Ç–∞: 100 –º–æ–Ω–µ—Ç</div>
<button onclick="openPack()">üéÅ –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø–∞–∫</button>
<button onclick="buyPack()">üíé –ö—É–ø–∏—Ç—å –ø–∞–∫ (50 –º–æ–Ω–µ—Ç)</button>
<p class="timer" id="timer"></p>
<div id="lastCard"></div>
<h2>–ú–æ—è –∫–æ–ª–ª–µ–∫—Ü–∏—è</h2>
<div id="collection"></div>

<!-- –ê–î–ú–ò–ù –ü–ê–ù–ï–õ–¨ -->
<div id="adminPanel">
<h2>–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</h2>
<button onclick="addCurrency(100)">üí∞ –î–æ–±–∞–≤–∏—Ç—å 100 –º–æ–Ω–µ—Ç</button>
<button onclick="resetCollection()">üóë –û—á–∏—Å—Ç–∏—Ç—å –∫–æ–ª–ª–µ–∫—Ü–∏—é</button>
<button onclick="resetTimer()">‚è∞ –°–±—Ä–æ—Å–∏—Ç—å —Ç–∞–π–º–µ—Ä</button>
</div>

<!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –ö–ê–†–¢–û–ß–ö–ò -->
<div id="cardModal">
  <div id="cardContent">
    <img id="modalImage" src="">
    <h2 id="modalName"></h2>
    <p id="modalRarity"></p>	
    <p id="modalType"></p>
    <button id="sellCardBtn">üí∞ –ü—Ä–æ–¥–∞—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É</button>
  </div>
</div>

<!-- –ù–ê–í–ë–ê–† -->
<div id="navbar">
  <button onclick="toggleMenu('clicker')">üñ± –ö–ª–∏–∫–∞–ª–∫–∞</button>
  <button onclick="toggleMenu('packs')">üéÅ –ü–∞–∫–∏</button>
  <button onclick="toggleMenu('leaderboard')">üèÜ –¢–æ–ø</button>
</div>

<!-- –ú–û–î–ê–õ–¨–ù–´–ï –û–ö–ù–ê –ú–ï–ù–Æ -->
<div id="clickerModal" class="menu-modal">
  <div class="menu-content">
    <div class="menu-header">
      <h2 class="menu-title">üñ± –ö–ª–∏–∫–∞–ª–∫–∞</h2>
      <button class="close-btn" onclick="closeMenu('clicker')">&times;</button>
    </div>
    <p>–ù–∞–∂–∏–º–∞–π –Ω–∞ –∫–æ—Ç–∏–∫–∞ –∏ –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞–π –º–æ–Ω–µ—Ç—ã!</p>
    <div class="cat-container" onclick="earnClick()">
      <video id="catVideo" muted>
        <source src="cat_petting.mp4" type="video/mp4">
        –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤–∏–¥–µ–æ.
      </video>
    </div>
    <p id="energyDisplay">‚ö° –≠–Ω–µ—Ä–≥–∏—è: 50/50</p>
  </div>
</div>

<div id="packsModal" class="menu-modal">
  <div class="menu-content">
    <div class="menu-header">
      <h2 class="menu-title">üéÅ –ú–∞–≥–∞–∑–∏–Ω –ø–∞–∫–æ–≤</h2>
      <button class="close-btn" onclick="closeMenu('packs')">&times;</button>
    </div>
    <button onclick="buyCommonPack()" style="width: 100%; margin: 10px 0; padding: 15px;">üü¶ –û–±—ã—á–Ω—ã–π –ø–∞–∫ (30 –º–æ–Ω–µ—Ç)</button>
    <button onclick="buyRarePack()" style="width: 100%; margin: 10px 0; padding: 15px;">üü© –†–µ–¥–∫–∏–π –ø–∞–∫ (100 –º–æ–Ω–µ—Ç)</button>
    <button onclick="buyLegendaryPack()" style="width: 100%; margin: 10px 0; padding: 15px;">üü® –õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π –ø–∞–∫ (300 –º–æ–Ω–µ—Ç)</button>
  </div>
</div>

<div id="leaderboardModal" class="menu-modal">
  <div class="menu-content">
    <div class="menu-header">
      <h2 class="menu-title">üèÜ –¢–æ–ø –∏–≥—Ä–æ–∫–æ–≤</h2>
      <button class="close-btn" onclick="closeMenu('leaderboard')">&times;</button>
    </div>
    <div id="leaderboardContent" style="max-height: 400px; overflow-y: auto;"></div>
  </div>
</div>

<script>
// FIREBASE
const firebaseConfig = {
  apiKey: "AIzaSyBIPugjKSmRvbDNFS_7ClFkbjlb8zfugXM",
  authDomain: "regcandy-74da6.firebaseapp.com",
  databaseURL: "https://regcandy-74da6-default-rtdb.firebaseio.com",
  projectId: "regcandy-74da6",
  storageBucket: "regcandy-74da6.appspot.com",
  messagingSenderId: "486732872284",
  appId: "1:486732872284:web:9621ddfb253c03ccd98499"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

// –ö–ê–†–¢–û–ß–ö–ò
const cards=[
  {name:"Reghype",rarity:"Special",type:"Twitch",image:"cards/Regcandy.png", tgLink:"https://t.me/reghypearchive/2"},
  {name:"DistrsAI",rarity:"Special",type:"Twitch",image:"cards/DistrsAI.png", tgLink:"https://t.me/reghypearchive/3"},
  {name:"Demogorgon",rarity:"Legendary",type:"Moder",image:"cards/Demogorgon.png", tgLink:"https://t.me/reghypearchive/4"},
  {name:"Apelsinka",rarity:"Legendary",type:"Moder",image:"cards/Apelsinka.png", tgLink:"https://t.me/reghypearchive/5"},
  {name:"Freddy Fuzbear",rarity:"Rare",type:"Chaters",image:"cards/Freddy.png", tgLink:"https://t.me/reghypearchive/6"},
  {name:"Bonnie",rarity:"Rare",type:"Chaters",image:"cards/Bonnie.png", tgLink:"https://t.me/reghypearchive/7"},
  {name:"Mark",rarity:"Rare",type:"Chaters",image:"cards/Mark.png", tgLink:"https://t.me/reghypearchive/8"},
  {name:"Anton Fazbear",rarity:"Common",type:"Chaters",image:"cards/Anton.png", tgLink:"https://t.me/reghypearchive/9"},
  {name:"–†–æ–Ω–∏",rarity:"Common",type:"Chaters",image:"cards/Roni.png", tgLink:"https://t.me/reghypearchive/10"},
  {name:"Neatexq",rarity:"Rare",type:"Chaters",image:"cards/Neatexq.png", tgLink:"https://t.me/reghypearchive/11"},
  {name:"Foxy",rarity:"Rare",type:"Chaters",image:"cards/Foxy.png", tgLink:"https://t.me/reghypearchive/12"},
  {name:"Andrew",rarity:"Common",type:"Chaters",image:"cards/Andrew.png", tgLink:"https://t.me/reghypearchive/13"},
  {name:"Che–±—Én–µ–ª—è",rarity:"Common",type:"Chaters",image:"cards/Chebunela.png", tgLink:"https://t.me/reghypearchive/14"},
  {name:"–ê–ª—ç—Ö",rarity:"Rare",type:"Chaters",image:"cards/Alex.png", tgLink:"https://t.me/reghypearchive/15"},
  {name:"Foxy Skin",rarity:"Special",type:"Skin",image:"cards/Foxy-Skin.png", tgLink:"https://t.me/reghypearchive/16"},
  {name:"Demogorgon Skin",rarity:"Special",type:"Skin",image:"cards/Demogorgon-Skin.png", tgLink:"https://t.me/reghypearchive/17"},
  {name:"Freddy Skin",rarity:"Special",type:"Skin",image:"cards/Freddy-Skin.png", tgLink:"https://t.me/reghypearchive/18"},
  {name:"X06R",rarity:"Common",type:"Chaters",image:"cards/X06R.png", tgLink:"https://t.me/reghypearchive/19"}
];

// –ü–ï–†–ï–ú–ï–ù–ù–´–ï
let collection = JSON.parse(localStorage.getItem('collection')) || [];
let currency = localStorage.getItem('currency') ? parseInt(localStorage.getItem('currency')) : 100;
let lastFreePack = parseInt(localStorage.getItem('lastFreePack')) || 0;
const packCooldown = 4*3600*1000;
let playerName = localStorage.getItem('playerName');
let energy = parseInt(localStorage.getItem('energy')) || 50;
const maxEnergy = 50;
const regenTime = 5000;

// –ù–ò–ö –ü–†–ò –ü–ï–†–í–û–ú –ó–ê–•–û–î–ï
if(!playerName){
  playerName = prompt("–ü—Ä–∏–¥—É–º–∞–π —Å–≤–æ–π –Ω–∏–∫:");
  localStorage.setItem('playerName', playerName);
  db.ref('players/' + playerName).set({currency: currency, cards: collection.length});
}

// –ê–î–ú–ò–ù-–ü–ê–ù–ï–õ–¨
let logoClickCount=0;
document.getElementById('logo').addEventListener('click',()=>{
  logoClickCount++;
  if(logoClickCount>=5){document.getElementById('adminPanel').classList.toggle('show'); logoClickCount=0;}
});

// –û–°–ù–û–í–ù–´–ï –§–£–ù–ö–¶–ò–ò
function getRandomCard(){
  let roll=Math.random()*100; let rarity;
  if(roll<=50) rarity="Common";
  else if(roll<=80) rarity="Rare";
  else if(roll<=95) rarity="Legendary";
  else rarity="Special";
  const possible=cards.filter(c=>c.rarity===rarity);
  return possible[Math.floor(Math.random()*possible.length)];
}

function openPack(){
  const now=Date.now();
  if(now-lastFreePack<packCooldown){
    const rem=packCooldown-(now-lastFreePack);
    const h=Math.floor(rem/3600000);
    const m=Math.floor((rem%3600000)/60000);
    alert(`–°–ª–µ–¥—É—é—â–∏–π –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø–∞–∫ —á–µ—Ä–µ–∑ ${h}—á ${m}–º`);
    return;
  }
  const card=getRandomCard();
  collection.push(card);
  lastFreePack=now;
  saveData();
  updatePlayerData();
  showLastCard(card);
  renderCollection();
}

function buyPack(){
  if(currency<50){alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç!");return;}
  currency-=50;
  const card=getRandomCard();
  collection.push(card);
  saveData();
  updatePlayerData();
  showLastCard(card);
  renderCollection();
}

function showLastCard(card){
  const container=document.getElementById('lastCard');
  container.innerHTML=`<div class="card rarity-${card.rarity} animate-card"><img src="${card.image}"><p>${card.name} (${card.rarity}, ${card.type})</p></div>`;
}

function renderCollection(){
  const container = document.getElementById('collection');
  container.innerHTML = '';
  collection.forEach((card,i)=>{
    const div = document.createElement('div');
    div.className = 'card rarity-' + card.rarity;
    div.innerHTML = `<img src="${card.image}"><p>${card.name} (${card.rarity})</p>`;
    div.onclick = ()=>showCardDetails(card,i);
    container.appendChild(div);
  });
}

function saveData(){
  localStorage.setItem('collection',JSON.stringify(collection));
  localStorage.setItem('currency',currency);
  localStorage.setItem('lastFreePack',lastFreePack);
  localStorage.setItem('energy', energy);
  document.getElementById('currency').innerText=`üí∞ –í–∞–ª—é—Ç–∞: ${currency} –º–æ–Ω–µ—Ç`;
}

function updateTimer(){
  const now=Date.now();
  const rem=packCooldown-(now-lastFreePack);
  const timerEl=document.getElementById('timer');
  if(rem>0){
    const h=Math.floor(rem/3600000);
    const m=Math.floor((rem%3600000)/60000);
    const s=Math.floor((rem%60000)/1000);
    timerEl.innerText=`–°–ª–µ–¥—É—é—â–∏–π –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø–∞–∫ —á–µ—Ä–µ–∑ ${h}—á ${m}–º ${s}—Å`;
  } else timerEl.innerText='–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø–∞–∫ –≥–æ—Ç–æ–≤!';
}

function updateEnergyDisplay() {
  const energyEl = document.getElementById('energyDisplay');
  if(energyEl) {
    energyEl.innerText = `‚ö° –≠–Ω–µ—Ä–≥–∏—è: ${energy}/${maxEnergy}`;
  }
}

function addCurrency(amount){currency+=amount; saveData(); updatePlayerData();}
function resetCollection(){collection=[]; saveData(); renderCollection(); updatePlayerData();}
function resetTimer(){lastFreePack=0; saveData(); updateTimer();}

// –ö–ê–†–¢–û–ß–ö–ê –ú–û–î–ê–õ–ö–ê
function showCardDetails(card,index){
  const modal = document.getElementById('cardModal');
  document.getElementById('modalImage').src = card.image;
  document.getElementById('modalName').innerText = card.name;
  document.getElementById('modalRarity').innerText = `–†–µ–¥–∫–æ—Å—Ç—å: ${card.rarity}`;
  document.getElementById('modalType').innerText = `–¢–∏–ø: ${card.type}`;
  
  const sellBtn = document.getElementById('sellCardBtn');
  sellBtn.onclick = ()=>{
    let price = 0;
    if(card.rarity==="Common") price=10;
    else if(card.rarity==="Rare") price=25;
    else if(card.rarity==="Special") price=50;
    else if(card.rarity==="Legendary") price=100;
    currency+=price;
    collection.splice(index,1);
    saveData();
    updatePlayerData();
    renderCollection();
    modal.style.display='none';
  };
  


  modal.style.display='flex';
}

document.getElementById('cardModal').addEventListener('click', function(e) {
  if (e.target.id === 'cardModal') {
    document.getElementById('cardModal').style.display = 'none';
  }
});


// –û–ù–õ–ê–ô–ù –¢–û–ü
function updatePlayerData(){
  db.ref('players/' + playerName).set({currency: currency, cards: collection.length});
  updateLeaderboard();
}

function updateLeaderboard(){
  db.ref('players').once('value', snapshot=>{
    const data = snapshot.val();
    if(!data) return;
    
    const arr = Object.entries(data)
      .map(([name, info]) => ({
        name: name || "–ò–≥—Ä–æ–∫",
        currency: info?.currency || 0,
        cards: info?.cards || 0
      }))
      .sort((a,b)=>b.currency - a.currency);

    const lb = document.getElementById('leaderboardContent');
    if(lb) {
      lb.innerHTML = '';
      arr.forEach((player, i)=>{
        lb.innerHTML += `<p>${i+1}. ${player.name} - ${player.currency} –º–æ–Ω–µ—Ç, ${player.cards} –∫–∞—Ä—Ç–æ—á–µ–∫</p>`;
      });
    }
  });
}


// –£–ü–†–ê–í–õ–ï–ù–ò–ï –ú–û–î–ê–õ–¨–ù–´–ú–ò –û–ö–ù–ê–ú–ò –ú–ï–ù–Æ
let currentOpenMenu = null;

function toggleMenu(menuType) {
  const modal = document.getElementById(menuType + 'Modal');
  const buttons = document.querySelectorAll('#navbar button');
  let targetButton = null;
  
  // –ù–∞–π—Ç–∏ –Ω–∞–∂–∞—Ç—É—é –∫–Ω–æ–ø–∫—É
  buttons.forEach(btn => {
    if(btn.onclick && btn.onclick.toString().includes(menuType)) {
      targetButton = btn;
    }
  });
  
  // –ï—Å–ª–∏ —É–∂–µ –æ—Ç–∫—Ä—ã—Ç–æ —ç—Ç–æ –º–µ–Ω—é - –∑–∞–∫—Ä—ã—Ç—å
  if (currentOpenMenu === menuType) {
    closeMenu(menuType);
    return;
  }
  
  // –ó–∞–∫—Ä—ã—Ç—å –¥—Ä—É–≥–∏–µ –º–µ–Ω—é
  closeAllMenus();
  
  // –û—Ç–∫—Ä—ã—Ç—å –Ω—É–∂–Ω–æ–µ –º–µ–Ω—é
  modal.style.display = 'flex';
  if(targetButton) targetButton.classList.add('active');
  currentOpenMenu = menuType;
  
  // –û–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ª–∏–¥–µ—Ä–±–æ—Ä–¥–∞
  if (menuType === 'leaderboard') {
    updateLeaderboard();
  }
}

function closeMenu(menuType) {
  const modal = document.getElementById(menuType + 'Modal');
  const buttons = document.querySelectorAll('#navbar button');
  let targetButton = null;
  
  buttons.forEach(btn => {
    if(btn.onclick && btn.onclick.toString().includes(menuType)) {
      targetButton = btn;
    }
  });
  
  modal.style.display = 'none';
  if(targetButton) targetButton.classList.remove('active');
  currentOpenMenu = null;
}

function closeAllMenus() {
  document.querySelectorAll('.menu-modal').forEach(modal => {
    modal.style.display = 'none';
  });
  document.querySelectorAll('#navbar button').forEach(btn => {
    btn.classList.remove('active');
  });
  currentOpenMenu = null;
}

// –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ –∫–ª–∏–∫—É –≤–Ω–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
document.addEventListener('click', function(e) {
  if (e.target.classList.contains('menu-modal')) {
    closeAllMenus();
  }
});

// –§–£–ù–ö–¶–ò–ò –ö–û–¢–ò–ö–ê
function animateCat() {
  const catVideo = document.getElementById('catVideo');
  const container = document.querySelector('.cat-container');
  
  if(container && catVideo) {
    container.classList.add('click-effect');
    setTimeout(() => {
      container.classList.remove('click-effect');
    }, 300);
    
    catVideo.currentTime = 0;
    catVideo.play();
  }
}

function earnClick() {
  if (energy <= 0) {
    alert("‚ö° –£ —Ç–µ–±—è –Ω–µ—Ç —ç–Ω–µ—Ä–≥–∏–∏! –ü–æ–¥–æ–∂–¥–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è.");
    return;
  }
  
  energy--;
  currency++;
  saveData();
  updateEnergyDisplay();
  animateCat();
}

// –ú–ê–ì–ê–ó–ò–ù –ü–ê–ö–û–í
function buyCommonPack(){
  if(currency<30){alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç!");return;}
  currency-=30;
  const card = getRandomCard();
  collection.push(card);
  saveData(); 
  renderCollection(); 
  updatePlayerData();
  showLastCard(card);
}

function buyRarePack(){
  if(currency<100){alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç!");return;}
  currency-=100;
  let rareCards=cards.filter(c=>c.rarity==="Rare"||c.rarity==="Special");
  const card = rareCards[Math.floor(Math.random()*rareCards.length)];
  collection.push(card);
  saveData(); 
  renderCollection(); 
  updatePlayerData();
  showLastCard(card);
}

function buyLegendaryPack(){
  if(currency<300){alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç!");return;}
  currency-=300;
  let legendaryCards=cards.filter(c=>c.rarity==="Legendary"||c.rarity==="Special");
  const card = legendaryCards[Math.floor(Math.random()*legendaryCards.length)];
  collection.push(card);
  saveData(); 
  renderCollection(); 
  updatePlayerData();
  showLastCard(card);
}

// –í–û–°–°–¢–ê–ù–û–í–õ–ï–ù–ò–ï –≠–ù–ï–†–ì–ò–ò
setInterval(()=>{
  if (energy < maxEnergy) {
    energy++;
    updateEnergyDisplay();
  }
}, regenTime);

// –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø
renderCollection();
updateTimer();
saveData();
updatePlayerData();
updateEnergyDisplay();
setInterval(updateTimer,1000);
setInterval(updateLeaderboard,10000);
</script>

</body>
</html>
