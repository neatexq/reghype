<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Reghype</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500&family=Roboto&display=swap" rel="stylesheet">

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<style>
body { margin:0; font-family:'Roboto',sans-serif; background: linear-gradient(135deg,#0d0d0d,#1a1a1a);
  color:#fff; text-align:center; overflow-x:hidden; }
h1 { font-family:'Orbitron',sans-serif; color:#ffcc00; margin:20px 0; cursor:pointer; text-shadow:0 0 10px #ffcc00; }
button { padding:12px 25px; margin:10px; border:none; border-radius:12px;
  background: linear-gradient(45deg,#ff6600,#ffcc00); font-weight:bold; color:#000; font-size:18px; cursor:pointer; transition:0.3s;
}
button:hover{transform:scale(1.05);}
#currency{font-size:22px;margin:10px;color:#00ff99;font-weight:bold;}
#lastCard{margin:20px;position:relative;height:200px;}
#collection{display:flex;flex-wrap:wrap;justify-content:center;}
.card{display:inline-block; margin:10px; text-align:center; transition:0.5s; border-radius:12px; padding:5px; position:relative;}
.card img{max-width:150px; border-radius:12px; transition:0.5s;}
.rarity-Common{border:3px solid gray; box-shadow:0 0 15px gray;}
.rarity-Rare{border:3px solid #3399ff; box-shadow:0 0 15px #3399ff; animation:glowBlue 2s infinite alternate;}
.rarity-Special{border:3px solid #cc33ff; box-shadow:0 0 20px #cc33ff; animation:glowPurple 2s infinite alternate;}
.rarity-Legendary{border:3px solid gold; box-shadow:0 0 25px gold; animation:glowGold 2s infinite alternate;}
@keyframes glowBlue{0%{box-shadow:0 0 15px #3399ff;}100%{box-shadow:0 0 30px #33f;}}
@keyframes glowPurple{0%{box-shadow:0 0 15px #cc33ff;}100%{box-shadow:0 0 35px #f3f;}}
@keyframes glowGold{0%{box-shadow:0 0 20px gold;}100%{box-shadow:0 0 40px #ff0;}}
.animate-card{transform:scale(0) rotateY(0deg); animation:popCard 0.8s forwards;}
@keyframes popCard{0%{transform:scale(0) rotateY(0deg);opacity:0;}50%{transform:scale(1.3) rotateY(180deg);opacity:1;}100%{transform:scale(1) rotateY(360deg);opacity:1;}}
.timer{font-size:16px;color:#ff6666;margin:10px;}
#adminPanel{position:fixed; top:50px; right:-400px; width:360px; background:#111; border:2px solid #ffcc00; border-radius:10px; padding:20px; transition:0.5s; z-index:1000;}
#adminPanel.show{right:20px;}
#adminPanel h2{color:#ffcc00;margin-top:0;font-family:'Orbitron',sans-serif;}
#adminPanel button{width:90%;margin:5px;}
#cardModal{display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.85); justify-content:center; align-items:center; z-index:2000;}
#cardContent{background:#111;padding:20px;border:3px solid #ffcc00;border-radius:15px;text-align:center;position:relative; max-width:300px; animation:modalPop 0.5s forwards;}
#cardContent img{max-width:100%;border-radius:12px;box-shadow:0 0 20px gold;margin-bottom:10px;}
@keyframes modalPop{0%{transform:scale(0);}60%{transform:scale(1.2);}100%{transform:scale(1);}}
#cardContent button{padding:8px 15px;margin-top:10px;border:none;border-radius:8px;background:#ff3333;color:#fff;cursor:pointer;transition:0.3s;}
#cardContent button:hover{transform:scale(1.05);}
</style>
</head>
<body>

<h1 id="logo">Reghype</h1>
<div id="currency">üí∞ –í–∞–ª—é—Ç–∞: 100 –º–æ–Ω–µ—Ç</div>
<button onclick="openPack()">üéÅ –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø–∞–∫</button>
<button onclick="buyPack()">üíé –ö—É–ø–∏—Ç—å –ø–∞–∫ (50 –º–æ–Ω–µ—Ç)</button>
<p class="timer" id="timer"></p>
<div id="lastCard"></div>
<h2>–ú–æ—è –∫–æ–ª–ª–µ–∫—Ü–∏—è</h2>
<div id="collection"></div>

<h2>–¢–æ–ø –∏–≥—Ä–æ–∫–æ–≤</h2>
<div id="leaderboard"></div>

<div id="adminPanel">
<h2>–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</h2>
<button onclick="addCurrency(100)">üí∞ –î–æ–±–∞–≤–∏—Ç—å 100 –º–æ–Ω–µ—Ç</button>
<button onclick="resetCollection()">üóë –û—á–∏—Å—Ç–∏—Ç—å –∫–æ–ª–ª–µ–∫—Ü–∏—é</button>
<button onclick="resetTimer()">‚è∞ –°–±—Ä–æ—Å–∏—Ç—å —Ç–∞–π–º–µ—Ä</button>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∫–∞—Ä—Ç–æ—á–∫–∏ -->
<div id="cardModal">
  <div id="cardContent">
    <span id="closeModal" style="position:absolute;top:10px;right:15px;cursor:pointer;font-size:22px;color:#ff3333;">&times;</span>
    <img id="modalImage" src="">
    <h2 id="modalName"></h2>
    <p id="modalRarity"></p>
    <p id="modalType"></p>
    <button id="sellCardBtn">üí∞ –ü—Ä–æ–¥–∞—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É</button>
    <button id="viewTgBtn">üîó –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤ TG</button>
  </div>
</div>

<script>
// ---- FIREBASE ----
const firebaseConfig = {
  apiKey: "AIzaSyBIPugjKSmRvbDNFS_7ClFkbjlb8zfugXM",
  authDomain: "regcandy-74da6.firebaseapp.com",
  databaseURL: "https://regcandy-74da6-default-rtdb.firebaseio.com",
  projectId: "regcandy-74da6",
  storageBucket: "regcandy-74da6.appspot.com",
  messagingSenderId: "486732872284",
  appId: "1:486732872284:web:9621ddfb253c03ccd98499"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

// ---- –ö–ê–†–¢–û–ß–ö–ò ----
const cards=[
  {name:"Reghype",rarity:"Special",type:"Twitch",image:"https://i.ibb.co/4ZkdscHc/Regcandy.png", tgLink:"https://t.me/reghypearchive/2"},
  {name:"DistrsAI",rarity:"Special",type:"Twitch",image:"https://i.ibb.co/RpcgpQP3/DistrsAI.png", tgLink:"https://t.me/reghypearchive/3"},
  {name:"Demogorgon",rarity:"Legendary",type:"Moder",image:"https://i.ibb.co/gL7N2X0/Demogorgon.png", tgLink:"https://t.me/reghypearchive/4"},
  {name:"Apelsinka",rarity:"Legendary",type:"Moder",image:"https://i.ibb.co/fzcGyTYS/Apelsinka.png", tgLink:"https://t.me/reghypearchive/5"},
  {name:"Freddy Fuzbear",rarity:"Rare",type:"Chaters",image:"https://i.ibb.co/2YK9JMZ4/Freddy.png", tgLink:"https://t.me/reghypearchive/6"},
  {name:"Bonnie",rarity:"Rare",type:"Chaters",image:"https://i.ibb.co/JRYhbkkr/Bonnie.png", tgLink:"https://t.me/reghypearchive/7"},
  {name:"Mark",rarity:"Rare",type:"Chaters",image:"https://i.ibb.co/9kP3JMg7/Mark.png", tgLink:"https://t.me/reghypearchive/8"},
  {name:"Anton Fazbear",rarity:"Common",type:"Chaters",image:"https://i.ibb.co/4wSYkmHs/Anton.png", tgLink:"https://t.me/reghypearchive/9"},
  {name:"–†–æ–Ω–∏",rarity:"Common",type:"Chaters",image:"https://i.ibb.co/vCqGvqwp/Roni.png", tgLink:"https://t.me/reghypearchive/10"},
  {name:"Neatexq",rarity:"Rare",type:"Chaters",image:"https://i.ibb.co/C3rhmgZW/Neatexq.png", tgLink:"https://t.me/reghypearchive/11"},
  {name:"Foxy",rarity:"Rare",type:"Chaters",image:"https://i.ibb.co/XfgNcQ23/Foxy.png", tgLink:"https://t.me/reghypearchive/12"},
  {name:"Andrew",rarity:"Common",type:"Chaters",image:"https://i.ibb.co/M5NDbCGm/Andrew.png", tgLink:"https://t.me/reghypearchive/13"},
  {name:"Che–±—Én–µ–ª—è",rarity:"Common",type:"Chaters",image:"https://i.ibb.co/NgKMHFjY/Chebunela.png", tgLink:"https://t.me/reghypearchive/14"},
  {name:"–ê–ª—ç—Ö",rarity:"Rare",type:"Chaters",image:"https://i.ibb.co/xqXgNgDr/Alex.png", tgLink:"https://t.me/reghypearchive/15"},
  {name:"Foxy Skin",rarity:"Special",type:"Skin",image:"https://i.ibb.co/5WGtgMgN/Foxy-Skin.png", tgLink:"https://t.me/reghypearchive/16"},
  {name:"Demogorgon Skin",rarity:"Special",type:"Skin",image:"https://i.ibb.co/bRQBfSBQ/Demogorgon-Skin.png", tgLink:"https://t.me/reghypearchive/17"},
  {name:"Freddy Skin",rarity:"Special",type:"Skin",image:"https://i.ibb.co/wZjcHdWR/Freddy-Skin.png", tgLink:"https://t.me/reghypearchive/18"},
  {name:"X06R",rarity:"Common",type:"Chaters",image:"https://i.ibb.co/d0CHmK8s/X06R.png", tgLink:"https://t.me/reghypearchive/19"}
];

// ---- –ü–ï–†–ï–ú–ï–ù–ù–´–ï ----
let collection = JSON.parse(localStorage.getItem('collection')) || [];
let currency = localStorage.getItem('currency') ? parseInt(localStorage.getItem('currency')) : 100;
let lastFreePack = parseInt(localStorage.getItem('lastFreePack')) || 0;
const packCooldown = 4*3600*1000;
let playerName = localStorage.getItem('playerName');

// ---- –ù–ò–ö –ü–†–ò –ü–ï–†–í–û–ú –ó–ê–•–û–î–ï ----
if(!playerName){
  playerName = prompt("–ü—Ä–∏–¥—É–º–∞–π —Å–≤–æ–π –Ω–∏–∫:");
  localStorage.setItem('playerName', playerName);
  db.ref('players/' + playerName).set({currency: currency, cards: collection.length});
}

// ---- –ê–î–ú–ò–ù-–ü–ê–ù–ï–õ–¨ ----
let logoClickCount=0;
document.getElementById('logo').addEventListener('click',()=>{
  logoClickCount++;
  if(logoClickCount>=5){document.getElementById('adminPanel').classList.toggle('show'); logoClickCount=0;}
});

// ---- –§–£–ù–ö–¶–ò–ò ----
function getRandomCard(){
  let roll=Math.random()*100; let rarity;
  if(roll<=50) rarity="Common";
  else if(roll<=80) rarity="Rare";
  else if(roll<=95) rarity="Special";
  else rarity="Legendary";
  const possible=cards.filter(c=>c.rarity===rarity);
  return possible[Math.floor(Math.random()*possible.length)];
}

function openPack(){
  const now=Date.now();
  if(now-lastFreePack<packCooldown){
    const rem=packCooldown-(now-lastFreePack);
    const h=Math.floor(rem/3600000);
    const m=Math.floor((rem%3600000)/60000);
    alert(`–°–ª–µ–¥—É—é—â–∏–π –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø–∞–∫ —á–µ—Ä–µ–∑ ${h}—á ${m}–º`);
    return;
  }
  const card=getRandomCard();
  collection.push(card);
  lastFreePack=now;
  saveData();
  updatePlayerData();
  showLastCard(card);
  renderCollection();
}

function buyPack(){
  if(currency<50){alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç!");return;}
  currency-=50;
  const card=getRandomCard();
  collection.push(card);
  saveData();
  updatePlayerData();
  showLastCard(card);
  renderCollection();
}

function showLastCard(card){
  const container=document.getElementById('lastCard');
  container.innerHTML=`<div class="card rarity-${card.rarity} animate-card"><img src="${card.image}"><p>${card.name} (${card.rarity}, ${card.type})</p></div>`;
}

function renderCollection(){
  const container = document.getElementById('collection');
  container.innerHTML = '';
  collection.forEach((card,i)=>{
    const div = document.createElement('div');
    div.className = 'card rarity-' + card.rarity;
    div.innerHTML = `<img src="${card.image}"><p>${card.name} (${card.rarity})</p>`;
    div.onclick = ()=>showCardDetails(card,i);
    container.appendChild(div);
  });
}

function saveData(){
  localStorage.setItem('collection',JSON.stringify(collection));
  localStorage.setItem('currency',currency);
  localStorage.setItem('lastFreePack',lastFreePack);
  document.getElementById('currency').innerText=`üí∞ –í–∞–ª—é—Ç–∞: ${currency} –º–æ–Ω–µ—Ç`;
}

function updateTimer(){
  const now=Date.now();
  const rem=packCooldown-(now-lastFreePack);
  const timerEl=document.getElementById('timer');
  if(rem>0){
    const h=Math.floor(rem/3600000);
    const m=Math.floor((rem%3600000)/60000);
    const s=Math.floor((rem%60000)/1000);
    timerEl.innerText=`–°–ª–µ–¥—É—é—â–∏–π –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø–∞–∫ —á–µ—Ä–µ–∑ ${h}—á ${m}–º ${s}—Å`;
  } else timerEl.innerText='–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø–∞–∫ –≥–æ—Ç–æ–≤!';
}

function addCurrency(amount){currency+=amount; saveData(); updatePlayerData();}
function resetCollection(){collection=[]; saveData(); renderCollection(); updatePlayerData();}
function resetTimer(){lastFreePack=0; saveData(); updateTimer();}

// ---- –ö–ê–†–¢–û–ß–ö–ê –ú–û–î–ê–õ–ö–ê ----
function showCardDetails(card,index){
  const modal = document.getElementById('cardModal');
  document.getElementById('modalImage').src = card.image;
  document.getElementById('modalName').innerText = card.name;
  document.getElementById('modalRarity').innerText = `–†–µ–¥–∫–æ—Å—Ç—å: ${card.rarity}`;
  document.getElementById('modalType').innerText = `–¢–∏–ø: ${card.type}`;
  
  const sellBtn = document.getElementById('sellCardBtn');
  sellBtn.onclick = ()=>{
    let price = 0;
    if(card.rarity==="Common") price=10;
    else if(card.rarity==="Rare") price=25;
    else if(card.rarity==="Special") price=50;
    else if(card.rarity==="Legendary") price=100;
    currency+=price;
    collection.splice(index,1);
    saveData();
    updatePlayerData();
    renderCollection();
    modal.style.display='none';
  };
  
  const tgBtn = document.getElementById('viewTgBtn');
  if(card.tgLink){
    tgBtn.style.display = 'inline-block';
    tgBtn.onclick = ()=>window.open(card.tgLink,'_blank');
  } else {
    tgBtn.style.display = 'none';
  }

  modal.style.display='flex';
}

document.getElementById('closeModal').onclick = ()=>{document.getElementById('cardModal').style.display='none';};

// ---- ONLINE TOP ----
function updatePlayerData(){
  db.ref('players/' + playerName).set({currency: currency, cards: collection.length});
  updateLeaderboard();
}

function updateLeaderboard(){
  db.ref('players').once('value', snapshot=>{
    const data = snapshot.val();
    if(!data) return;
    const arr = Object.entries(data).sort((a,b)=>b[1].currency - a[1].currency);
    const lb = document.getElementById('leaderboard');
    lb.innerHTML = '<h3>–¢–æ–ø –∏–≥—Ä–æ–∫–æ–≤:</h3>';
    arr.forEach(([name, info],i)=>{
      lb.innerHTML += `<p>${i+1}. ${name} - ${info.currency} –º–æ–Ω–µ—Ç, ${info.cards} –∫–∞—Ä—Ç–æ—á–µ–∫</p>`;
    });
  });
}

// ---- –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ----
renderCollection();
updateTimer();
saveData();
updatePlayerData();
setInterval(updateTimer,1000);
setInterval(updateLeaderboard,10000);

</script>
</body>
</html>
